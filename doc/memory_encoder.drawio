<mxfile host="Electron" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.2.2 Chrome/134.0.6998.178 Electron/35.1.2 Safari/537.36" version="26.2.2">
  <diagram name="Page-1" id="1REGdSonj1GqQm5RxP3o">
    <mxGraphModel dx="3839" dy="3047" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="1" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="9adSApc8NBtUGI340YqG-1" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=2;" vertex="1" parent="1">
          <mxGeometry x="970" y="-1000" width="890" height="850" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-2" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=2;" vertex="1" parent="1">
          <mxGeometry x="1470.0000000000002" y="-536.75" width="390" height="346.75" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-3" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="1470.0000000000002" y="-676.1099999999999" width="390" height="118.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-83" target="9adSApc8NBtUGI340YqG-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-5" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=4;" vertex="1" parent="1">
          <mxGeometry x="1195.7500000000002" y="-917.25" width="260" height="699" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-6" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=2;" vertex="1" parent="1">
          <mxGeometry x="1082.2500000000002" y="64.5" width="550" height="670" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-7" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=2;" vertex="1" parent="1">
          <mxGeometry x="1082.2500000000002" y="174.5" width="440" height="470" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-8" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="1212.2500000000002" y="364.5" width="310" height="220" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-9" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=5;" vertex="1" parent="1">
          <mxGeometry x="1250.9400000000003" y="174.5" width="271.31" height="120" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-10" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="970" y="-877.3800000000001" width="210" height="80" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-11" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;4096,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;B, 256&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1106.03" y="-1018" width="68.85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-13" target="9adSApc8NBtUGI340YqG-201">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1103.1200000000001" y="-140" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1103" y="-162" />
              <mxPoint x="1377" y="-162" />
              <mxPoint x="1377" y="-122" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-13" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1093.12" y="-842.3800000000001" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-15" target="9adSApc8NBtUGI340YqG-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-15" value="No Mem Embed" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="992.5100000000002" y="-847.3800000000001" width="72.5" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-16" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;1,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;1, 256&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="987.5" y="-817.3800000000001" width="85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-17" value="backbone&amp;nbsp;&lt;div&gt;FPN[2]&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium; background-color: transparent; color: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));&quot;&gt;â‘¡&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;strokeColor=#314354;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1053.12" y="-1048" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-18" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;B, 256, 64, 64&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1109.0000000000002" y="-822.3800000000001" width="68.85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-19" value="_prepare_memory&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); background-color: transparent;&quot;&gt;_&lt;/span&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;conditioned_features()&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="973.1199999999999" y="-1000" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-21" target="9adSApc8NBtUGI340YqG-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-21" value="high_res_mask" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1282.2500000000002" y="4.5" width="99.5" height="29.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-23" target="9adSApc8NBtUGI340YqG-26">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1332.0100000000004" y="124.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-23" value="Binarize (\(a_{ij}\) &amp;gt; 0 ? 1 : 0)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1264.3800000000003" y="65.5" width="135.25" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-24" value="B, 1, 1024, 1024" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1332.2500000000002" y="38" width="92.87" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-25" value="B, 1, 1024, 1024" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1332.2500000000002" y="99.5" width="92.87" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-26" value="\(\cdot \times 20 - 10\)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1293.0700000000004" y="123" width="77.87" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-27" value="Conv [k3, s2, p1] (f)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1272.0000000000002" y="184.5" width="120" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-28" value="Layer Norm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1272.0000000000002" y="205" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-30" target="9adSApc8NBtUGI340YqG-34">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1332.0000000000002" y="264.5" as="targetPoint" />
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-30" value="GELU" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1272.0000000000002" y="225" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-31" value="f=[4,16,64,256]" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1399.63" y="195" width="90" height="22.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-26" target="9adSApc8NBtUGI340YqG-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-34" target="9adSApc8NBtUGI340YqG-43">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1332.0000000000002" y="314.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-34" value="Conv [k1, s1] (256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1272.0000000000002" y="268.5" width="120" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-35" value="B, 256, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1341.6000000000001" y="294.5" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-36" value="MaskDownSampler" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1399.63" y="174.5" width="110" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-38" target="9adSApc8NBtUGI340YqG-41">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-38" value="backbone&amp;nbsp;&lt;div&gt;FPN[2]&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium; background-color: transparent; color: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));&quot;&gt;â‘¡&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;strokeColor=#314354;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="1141.2500000000002" y="4" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-39" value="B, 256, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1192.0000000000002" y="38" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-41" target="9adSApc8NBtUGI340YqG-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-41" value="Conv [k1, s1] (256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1131.2500000000002" y="332.5" width="120" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-43" target="9adSApc8NBtUGI340YqG-45">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-43" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1318.4999999999998" y="329.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-44" value="B, 256, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1246.2500000000002" y="348.5" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-45" value="Conv [k7, p3, g256] (256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1261.1200000000001" y="385.25" width="141.13" height="19.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-46" value="Layer Norm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1261.1200000000001" y="405" width="141.13" height="19.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-47" value="Linear(1024)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1261.1200000000001" y="425" width="141.13" height="19.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-48" value="GELU" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1261.1200000000001" y="444.5" width="141.13" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-50" target="9adSApc8NBtUGI340YqG-55">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1331.6000000000006" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-50" value="Linear(256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1261.1200000000001" y="465" width="141.13" height="19.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-52" target="9adSApc8NBtUGI340YqG-55">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1321.6000000000006" y="520" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-52" value="Learnable gamma" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1220.2500000000002" y="497.75" width="61" height="44.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-53" value="256" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1230.0000000000002" y="544.5" width="42" height="12.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-55" target="9adSApc8NBtUGI340YqG-58">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1331.6799999999996" y="554.4999999999998" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1331.2500000000002" y="554.5" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-55" value="\(\times\)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1318.1799999999996" y="506.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-56" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;endArrow=none;startFill=1;startArrow=classic;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-58">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1332.2500000000002" y="374.5" as="targetPoint" />
            <mxPoint x="1444.5699999999993" y="549.5" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1422.25" y="454.5" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-57" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-58">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1331.6799999999996" y="604.5000000000002" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-58" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1318.1799999999996" y="554.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-59" value="B, 256, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1241.2500000000002" y="581.5" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-60" value="CXBlock \(\times2\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1432.25" y="389.5" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-61" value="Fuser" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1442.25" y="367.5" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-62" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-63" target="9adSApc8NBtUGI340YqG-74">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1332.2500000000002" y="664.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-63" value="Conv [k1, s1] (64)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1261.4400000000003" y="604.8800000000001" width="141.13" height="19.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-64" value="B, 64, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1241.2500000000002" y="625.25" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-65" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-66" target="9adSApc8NBtUGI340YqG-82">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1184.2500000000002" y="744.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-66" value="Position Embedding Sine" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1139.0000000000002" y="590" width="91" height="35.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-67" value="B, 64, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1105.0000000000002" y="710.8699999999999" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-68" value="Memory Encoder" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1082.2500000000002" y="174" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-70" target="9adSApc8NBtUGI340YqG-72">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-70" value="obj_score_logits&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;â‘¦&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1532.25" y="4" width="99.5" height="29.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-72" target="9adSApc8NBtUGI340YqG-76">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-72" value="if score &amp;lt;= 0" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1532.25" y="667.74" width="100" height="48.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-74" target="9adSApc8NBtUGI340YqG-81">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1331.2500000000002" y="744.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-74" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="1318.1799999999996" y="678.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-76" target="9adSApc8NBtUGI340YqG-74">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-76" value="Learnable no_obj_embed_spatical" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1371.2500000000002" y="673.3699999999999" width="131" height="37.25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-77" value="B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1410.44" y="715.1199999999999" width="52.62" height="12" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-78" value="B, 64, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1246.2500000000002" y="710.6199999999999" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-79" value="B, 1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1522.25" y="37.5" width="92.87" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-80" value="_encode_new_memory()" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1080.0000000000002" y="64" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-81" value="maskmem_feature&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;&lt;font style=&quot;color: rgb(255, 255, 255);&quot;&gt;â‘§&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1273.5" y="745.75" width="117.01" height="29.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-82" value="maskmem_pos_enc&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;&lt;font style=&quot;color: rgb(255, 255, 255);&quot;&gt;â‘¨&lt;/font&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1119.99" y="744.75" width="129.18" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-83" value="maskmem_pos_enc&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;â‘¨&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-532.8" width="121.87" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-84" value="[i], 4096, B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1657.2599999999993" y="-506.75" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-85" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.21;entryY=0.014;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-86" target="9adSApc8NBtUGI340YqG-109">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1635.9199999999992" y="-640.0000000000002" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-86" value="maskmem_feature&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;â‘§&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-731.6600000000001" width="111.87" height="29.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-88" target="9adSApc8NBtUGI340YqG-112">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1656.6499999999996" y="-428.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-88" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1646.6599999999999" y="-468.25" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-89" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-90" target="9adSApc8NBtUGI340YqG-88">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-90" value="maskmem_tpos_enc[i]" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1476.66" y="-473.25" width="126.37" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-91" value="7, 1, 1, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1499.8499999999997" y="-443.25" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-92" value="1, 1, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1599.0499999999993" y="-476.8699999999999" width="47.61" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-93" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-94" target="9adSApc8NBtUGI340YqG-98">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1801.6799999999994" y="-405" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-94" value="1D sine positional encoding" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1747.4899999999998" y="-471.75" width="108.15" height="34.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-95" value="\(x \in \) [1, 2, ...,16]/15&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1747.4899999999998" y="-498.25" width="108.33" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-96" value="[j], 256" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1810.7599999999993" y="-435" width="52.13" height="25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-97" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-98" target="9adSApc8NBtUGI340YqG-101">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1801.5699999999997" y="-355" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1801.6799999999994" y="-355" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-98" value="Linear(64)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1751.5699999999997" y="-405" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-99" value="[j], 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1810.7599999999993" y="-380" width="52.13" height="25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-100" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-101" target="9adSApc8NBtUGI340YqG-112">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1802.5149999999994" y="-305" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1802.2599999999993" y="-313.25" />
              <mxPoint x="1706.2599999999993" y="-313.25" />
              <mxPoint x="1706.2599999999993" y="-286.25" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-101" value="Repeat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1753.46" y="-355" width="98.11" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-102" value="4[j], B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1737.2599999999993" y="-318.25" width="57.21" height="25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-103" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.788;entryY=0.033;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-104" target="9adSApc8NBtUGI340YqG-109">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1772.4799999999996" y="-648.2500000000002" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-104" value="obj_ptr&lt;span style=&quot;font-family: &amp;quot;Times New Roman&amp;quot;; font-size: medium;&quot;&gt;â‘¥&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-702.1600000000001" width="111.87" height="29.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-105" value="[j], 1, 256" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1719.5699999999997" y="-676.1100000000001" width="56.71" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-106" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1641.0899999999992" y="-600.73" as="targetPoint" />
            <mxPoint x="1641.1113924050633" y="-622.8599999999997" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-107" value="4096[i]+4[j], B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1642.7399999999998" y="-619.5500000000002" width="100" height="13.88" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-108" value="[i], B, 64, 64, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1576.3599999999997" y="-676.6100000000001" width="89.69" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-109" value="Reshape + Permute + Concat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1522.8999999999996" y="-649.6100000000001" width="236.53" height="26.75" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-110" value="4096, B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1653.0199999999995" y="-453.25" width="80" height="20.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-111" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-112">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1681.3149999999996" y="-228.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-112" value="Concat" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1632.2599999999993" y="-286.25" width="98.11" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-113" value="4096[i]+4[j], B, 64" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1683.6599999999999" y="-247.3699999999999" width="103" height="18" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-114" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" target="9adSApc8NBtUGI340YqG-13">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1103.1627536231883" y="-908.8972250434022" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-115" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-116" target="9adSApc8NBtUGI340YqG-127">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-116" value="is_init_cond_frame" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1042.929999999999" y="-957.4000000000001" width="120.38" height="48.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-117" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0.041;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-17" target="9adSApc8NBtUGI340YqG-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-118" value="True" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1093.12" y="-908.8800000000001" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-119" value="False" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1292.2599999999995" y="-957.25" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-120" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-121" target="9adSApc8NBtUGI340YqG-125">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-121" value="2D sine positional encoding&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1325.7500000000002" y="-1050" width="98.38" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-122" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-123" target="9adSApc8NBtUGI340YqG-125">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-123" value="0.1" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1413.3899999999996" y="-989.8699999999999" width="20" height="19.75" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-124" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-125" target="9adSApc8NBtUGI340YqG-127">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-125" value="\(\times\)" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1361.3299999999992" y="-993.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-126" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-127" target="9adSApc8NBtUGI340YqG-133">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1374.8299999999992" y="-898.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-127" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1361.3299999999992" y="-946.5" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-128" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;4096,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;B, 256&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1380.0000000000002" y="-1020" width="68.85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-129" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;4096,&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;B, 256&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1302.4600000000003" y="-919.5" width="68.85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-130" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-133" target="9adSApc8NBtUGI340YqG-134">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-131" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-133" target="9adSApc8NBtUGI340YqG-134">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-132" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-133" target="9adSApc8NBtUGI340YqG-134">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-133" value="LayerNorm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1329.91" y="-896.25" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-134" value="RoPEAttention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1329.91" y="-822.23" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-135" value="" style="rounded=1;whiteSpace=wrap;html=1;dashed=1;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="1466.0599999999997" y="-984.1500000000001" width="393.94" height="251.75" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-136" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-137" target="9adSApc8NBtUGI340YqG-143">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-137" value="Q" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1589.5" y="-949.1499999999999" width="30" height="22.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-138" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-139" target="9adSApc8NBtUGI340YqG-145">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-139" value="K" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1649.5" y="-949.1499999999999" width="30" height="22.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-140" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-141" target="9adSApc8NBtUGI340YqG-147">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-141" value="V" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1709.5" y="-949.1499999999999" width="30" height="22.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-142" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-143" target="9adSApc8NBtUGI340YqG-154">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1604.5" y="-859.1499999999999" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-143" value="Linear" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1579.5" y="-901.6499999999999" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-144" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-145" target="9adSApc8NBtUGI340YqG-182">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-145" value="Linear" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1639.5" y="-901.6499999999999" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-146" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-147" target="9adSApc8NBtUGI340YqG-154">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1724.5" y="-859.1499999999999" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-147" value="Linear" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1699.5" y="-901.6499999999999" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-148" value="B, L\(_q\), C\(_i\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1549.5" y="-921.0899999999999" width="55" height="9" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-149" value="B, L\(_{kv}\), C\(_i\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1660.25" y="-921.6499999999999" width="63.75" height="9.88" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-150" value="B, L\(_{kv}\), C\(_i\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1724" y="-923.0800000000002" width="65.75" height="12.75" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-151" value="B, L\(_q\), head, C\(_j\)/head" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1479.5000000000002" y="-881.6499999999999" width="120" height="19" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-152" value="B, L\(_{kv}\), head, C\(_j\)/head" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1727.5" y="-877.1499999999999" width="123" height="10" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-153" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-154" target="9adSApc8NBtUGI340YqG-156">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-154" value="Scaled Dot Product Attention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1617.0599999999995" y="-813.1499999999999" width="94" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-155" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-156">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1664.75" y="-724.1499999999999" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-156" value="Linear" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1639.75" y="-764.1499999999999" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-157" value="B, L\(_q\), head, C\(_j\)/head" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1669.75" y="-783.1499999999999" width="120" height="19" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-158" value="B, L\(_q\), C\(_i\)" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1639.4299999999998" y="-748.9999999999999" width="120" height="19" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-159" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;&quot;&gt;RoPEAttention&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1635.5" y="-984.1499999999999" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-160" value="head = 1" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1490.0999999999997" y="-812.3799999999999" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-161" value="self-C\(_j\) = 256&lt;div&gt;cross-&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;C\(_j\) = 256&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;k=4096[i]&lt;/span&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1486.78" y="-789.6499999999999" width="92.72" height="45.5" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-162" value="R" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1611.87" y="-858.3999999999999" width="23.63" height="22" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-163" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-182" target="9adSApc8NBtUGI340YqG-154">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1664.88" y="-828.3999999999999" as="targetPoint" />
            <mxPoint x="1664.88" y="-881.3999999999999" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-164" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-165" target="9adSApc8NBtUGI340YqG-168">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-165" value="Dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1329.91" y="-792.23" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-166" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;endArrow=none;startFill=1;startArrow=classic;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-168">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1375.1299999999994" y="-908.25" as="targetPoint" />
            <mxPoint x="1453.3099999999988" y="-678.25" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1432.1299999999994" y="-788.25" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-167" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-168">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1374.8899999999996" y="-692.23" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-168" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1361.3899999999996" y="-742.23" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-169" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.25;entryY=0;entryDx=0;entryDy=0;exitX=0.25;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-171" target="9adSApc8NBtUGI340YqG-172">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1354.4499999999991" y="-680.73" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-170" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" target="9adSApc8NBtUGI340YqG-186">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1375.7500000000002" y="-708.25" as="sourcePoint" />
            <mxPoint x="1395.5499999999795" y="-545.73" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1315.7500000000002" y="-628.25" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-171" value="LayerNorm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1330.6399999999996" y="-692.23" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-172" value="RoPEAttention" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="1330.6400000000006" y="-583.73" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-173" value="memory (key)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1599.1499999999996" y="-600.21" width="88.15" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-174" value="key pos" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1637.2399999999998" y="-228.25" width="88.15" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-175" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-177" target="9adSApc8NBtUGI340YqG-179">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-176" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-177" target="9adSApc8NBtUGI340YqG-172">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1398.0000000000002" y="-651" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-177" value="memory (key)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1213.0000000000002" y="-666.25" width="88.15" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-178" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-179" target="9adSApc8NBtUGI340YqG-172">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-179" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1362.0599999999997" y="-630.73" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-180" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-181" target="9adSApc8NBtUGI340YqG-179">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-181" value="key pos" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="1212.1000000000006" y="-632.23" width="88.15" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-182" value="R[:k]" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1645.6499999999996" y="-872.3999999999999" width="36.82" height="33" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-183" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-184" target="9adSApc8NBtUGI340YqG-186">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-184" value="Dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1330.7500000000002" y="-553.73" width="89.84" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-185" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-186">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1375.6699999999994" y="-449.75" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-186" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1362.1699999999994" y="-499.75" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-187" value="LayerNorm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1330.7500000000002" y="-449.75" width="91.62" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-188" value="Linear(2048)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1330.7500000000002" y="-419.75" width="91.62" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-189" value="ReLU" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1331.2500000000002" y="-390.25" width="91.12" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-190" value="Linear(256)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1331.2500000000002" y="-330.25" width="91.12" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-191" value="Dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1331.2500000000002" y="-360.25" width="91.12" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-192" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-193" target="9adSApc8NBtUGI340YqG-196">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1376.8099999999997" y="-239.75" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-193" value="Dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="1331.2500000000002" y="-300.25" width="91.12" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-194" style="edgeStyle=elbowEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;endArrow=none;startFill=1;startArrow=classic;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-196">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1375.3700000000001" y="-463.75" as="targetPoint" />
            <mxPoint x="1402.6800000000005" y="-225.25" as="sourcePoint" />
            <Array as="points">
              <mxPoint x="1446.0599999999997" y="-285.25" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-195" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-196" target="9adSApc8NBtUGI340YqG-199">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1376.5599999999997" y="-198.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-196" value="+" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="1363.0599999999997" y="-249.75" width="27" height="27" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-197" value="MemoryAttention \(\times\)4" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1200.7500000000002" y="-893.75" width="125" height="25" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-198" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9adSApc8NBtUGI340YqG-199" target="9adSApc8NBtUGI340YqG-201">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1376.450000000001" y="-138.25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-199" value="LayerNorm" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1330.6400000000006" y="-198.25" width="91.62" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-200" value="&lt;span style=&quot;font-size: 11px; text-wrap-mode: nowrap; background-color: rgb(255, 255, 255);&quot;&gt;B, 256, 64, 64&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1394.2100000000003" y="-170" width="68.85" height="20" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-201" value="pix_feat_with_mem" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#647687;fontColor=#ffffff;strokeColor=#314354;" vertex="1" parent="1">
          <mxGeometry x="1324.1799999999996" y="-132.5" width="105.26" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-202" value="i\(_{max}\) = 7" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1576.3599999999997" y="-706.25" width="52.37" height="16" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-203" value="At frame #N, the&amp;nbsp;&lt;span style=&quot;text-align: left;&quot;&gt;maskmem_features are:&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-833.58" width="228.13" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-204" value="Select the closest cond_&lt;span style=&quot;text-align: left;&quot;&gt;frame&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-802.23" width="198.13" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-205" value="Previous [N-6:N-1] non_cond_&lt;span style=&quot;text-align: left;&quot;&gt;frame&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-772.23" width="198.13" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-206" value="j\(_{max}\) = 16" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1701.87" y="-706.75" width="72.24" height="16" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-207" value="Previous [N-15:N-1] non_cond_&lt;span style=&quot;text-align: left;&quot;&gt;frame&amp;nbsp;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1885.9299999999998" y="-605.6700000000001" width="214.07" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-208" value="At frame #N, the&amp;nbsp;&lt;span style=&quot;text-align: left;&quot;&gt;obj_ptr&lt;/span&gt;&lt;span style=&quot;text-align: left;&quot;&gt;&amp;nbsp;are:&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1880" y="-665.6700000000001" width="168.13" height="30" as="geometry" />
        </mxCell>
        <mxCell id="9adSApc8NBtUGI340YqG-209" value="Select the closest cond_&lt;span style=&quot;text-align: left;&quot;&gt;frame&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1885.9299999999998" y="-636.25" width="214.07" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
